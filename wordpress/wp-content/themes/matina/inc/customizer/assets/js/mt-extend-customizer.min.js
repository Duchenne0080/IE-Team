/**
 * Script for Extend Customizer Panel
 *
 * @package Matina
 */
!function(t){var e=wp.customize;e.bind("pane-contents-reflowed",function(){var n=[];e.section.each(function(t){"matina_section"===t.params.type&&void 0!==t.params.section&&n.push(t)}),n.sort(e.utils.prioritySort).reverse(),t.each(n,function(e,n){t("#sub-accordion-section-"+n.params.section).children(".section-meta").after(n.headContainer)});var a=[];e.panel.each(function(t){"matina_panel"===t.params.type&&void 0!==t.params.panel&&a.push(t)}),a.sort(e.utils.prioritySort).reverse(),t.each(a,function(e,n){t("#sub-accordion-panel-"+n.params.panel).children(".panel-meta").after(n.headContainer)})});var n=wp.customize.Panel.prototype.embed,a=wp.customize.Panel.prototype.isContextuallyActive,i=wp.customize.Panel.prototype.attachEvents;wp.customize.Panel=wp.customize.Panel.extend({attachEvents:function(){if("matina_panel"===this.params.type&&void 0!==this.params.panel){i.call(this);var t=this;t.expanded.bind(function(n){var a=e.panel(t.params.panel);n?a.contentContainer.addClass("current-panel-parent"):a.contentContainer.removeClass("current-panel-parent")}),t.container.find(".customize-panel-back").off("click keydown").on("click keydown",function(n){e.utils.isKeydownButNotEnterEvent(n)||(n.preventDefault(),t.expanded()&&e.panel(t.params.panel).expand())})}else i.call(this)},embed:function(){if("matina_panel"===this.params.type&&void 0!==this.params.panel){n.call(this);t("#sub-accordion-panel-"+this.params.panel).append(this.headContainer)}else n.call(this)},isContextuallyActive:function(){if("matina_panel"!==this.params.type)return a.call(this);var t=this,n=this._children("panel","section");e.panel.each(function(e){e.params.panel&&e.params.panel===t.id&&n.push(e)}),n.sort(e.utils.prioritySort);var i=0;return _(n).each(function(t){t.active()&&t.isContextuallyActive()&&(i+=1)}),0!==i}});var o=wp.customize.Section.prototype.embed,s=wp.customize.Section.prototype.isContextuallyActive,c=wp.customize.Section.prototype.attachEvents;wp.customize.Section=wp.customize.Section.extend({attachEvents:function(){if("matina_section"===this.params.type&&void 0!==this.params.section){c.call(this);var t=this;t.expanded.bind(function(n){var a=e.section(t.params.section);n?a.contentContainer.addClass("current-section-parent"):a.contentContainer.removeClass("current-section-parent")}),t.container.find(".customize-section-back").off("click keydown").on("click keydown",function(n){e.utils.isKeydownButNotEnterEvent(n)||(n.preventDefault(),t.expanded()&&e.section(t.params.section).expand())})}else c.call(this)},embed:function(){if("matina_section"===this.params.type&&void 0!==this.params.section){o.call(this);t("#sub-accordion-section-"+this.params.section).append(this.headContainer)}else o.call(this)},isContextuallyActive:function(){if("matina_section"!==this.params.type)return s.call(this);var t=this,n=this._children("section","control");e.section.each(function(e){e.params.section&&e.params.section===t.id&&n.push(e)}),n.sort(e.utils.prioritySort);var a=0;return _(n).each(function(t){void 0!==t.isContextuallyActive?t.active()&&t.isContextuallyActive()&&(a+=1):t.active()&&(a+=1)}),0!==a}})}(jQuery);